
<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes">
<meta name="theme-color" content="#4F7DC9">
<meta charset="UTF-8">
<title>Cloud-Native Observability with Dynatrace</title>
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
<link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="../../elements/codelab-elements/codelab-elements.css">
<style>
.success{color:#1e8e3e}.error{color:red} </style>
</head>
<body>
<google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
<google-codelab codelab-gaid="UA-175467274-1" id="cloud-native-observability" title="Cloud-Native Observability with Dynatrace" environment="web" feedback-link="mailto:APAC-SE-Central@dynatrace.com">
<google-codelab-step label="Introduction" duration="1">
<p>This repository contains the hands on for the Day 2 Operations - Cloud Native Observability Workshop.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Dynatrace SaaS/Managed Account. Get your free SaaS trial <a href="https://www.dynatrace.com/trial/" target="_blank">here</a>.</li>
<li>AWS account, with the ability to create an EC2 instance from a public AMI. Signup to a free trial <a href="https://aws.amazon.com/free/" target="_blank">here</a>.</li>
<li>Chrome Browser</li>
<li>SSH client such as <a href="https://mobaxterm.mobatek.net/" target="_blank">mobaxterm</a>.</li>
</ul>
<h2 is-upgraded>Lab Setup</h2>
<p>The following steps are used for this lab:</p>
<ul>
<li>Sample Application <ul>
<li>Sample App is based on <a href="https://github.com/dynatrace-sockshop" target="_blank">Sockshop</a></li>
</ul>
</li>
</ul>
<h2 class="checklist" is-upgraded>What You&#39;ll Learn</h2>
<ul>
<li>Deploy OneAgent to a Kubernetes / Microservice Environment</li>
<li>GitOps / Monitoring as code approach to push application config</li>
<li>DEM / Session Properties / Request Attributes</li>
<li>Learn Metric Ingestion for automated baselines across all entities</li>
<li>Site Reliability Engineering - Service Level Objectives</li>
</ul>
</google-codelab-step>
<google-codelab-step label="Basic Setup" duration="15">
<p>In this exercise, we will deploy the OneAgent to a Linux instance running Kubernetes(Microk8s) and let the OneAgent discover what is running in that instance.</p>
<h2 is-upgraded>Using Terminal via Web Browser</h2>
<p>To faciliate the labs, we will access the Linux instance <strong>via terminal through a web browser</strong>.</p>
<p>Use the <strong>URL</strong> was provided in your email to access the SSH terminal. Make sure the URL looks like <code>Public IP Address/wetty</code></p>
<p>Use the <strong>login name</strong> and <strong>password</strong> as provided in your email.</p>
<p class="image-container"><img alt="Deploy" src="img/e609666e1c136993.png"></p>
<h2 is-upgraded>Download the OneAgent</h2>
<p>Open your browser and access the Dynatrace URL.</p>
<p>Follow these steps below:</p>
<ul>
<li>Select <strong>Dynatrace Hub</strong> from the navigation menu.</li>
<li>Select <strong>Kubernetes</strong></li>
<li>Select <strong>Monitor Kubernetes</strong> button from the bottom right.<br></li>
</ul>
<p class="image-container"><img alt="Deploy" src="img/45b66680fc9a6e5f.gif"></p>
<p>Within the <strong>Monitor Kubernetes / Openshift</strong> page, follow these steps below:</p>
<ul>
<li>Enter a <strong>Name</strong> for the connection Eg. <code>k8s</code></li>
<li>Click on <strong>Create tokens</strong> to create PaaS and API tokens with appropriate permissions</li>
<li><strong>Toggle ON</strong> Skip SSL Certificate Check</li>
<li>Click <strong>Copy</strong> button to copy the commands.</li>
<li><strong>Paste</strong> the command into your terminal window and execute it.</li>
</ul>
<p class="image-container"><img alt="Deploy" src="img/c6fc346f07810836.gif"></p>
<p>Example:</p>
<pre><code language="language-bash" class="language-bash">Connecting to github-releases.githubusercontent.com (github-releases.githubusercontent.com)|185.199.108.154|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 7310 (7.1K) [application/octet-stream]
Saving to: ‘install.sh&#39;

install.sh                      100%[=====================================================&gt;]   7.14K  --.-KB/s    in 0s      

2021-06-01 05:46:36 (40.7 MB/s) - ‘install.sh&#39; saved [7310/7310]


Check for token scopes...

Check if cluster already exists...

Creating Dynatrace namespace...

Applying Dynatrace Operator...
Warning: apiextensions.k8s.io/v1beta1 CustomResourceDefinition is deprecated in v1.16+, unavailable in v1.22+; use apiextensions.k8s.io/v1 CustomResourceDefinition
customresourcedefinition.apiextensions.k8s.io/dynakubes.dynatrace.com created
serviceaccount/dynatrace-dynakube-oneagent created
serviceaccount/dynatrace-dynakube-oneagent-unprivileged created
serviceaccount/dynatrace-kubernetes-monitoring created
serviceaccount/dynatrace-operator created
serviceaccount/dynatrace-routing created
podsecuritypolicy.policy/dynatrace-dynakube-oneagent created
podsecuritypolicy.policy/dynatrace-dynakube-oneagent-unprivileged created
podsecuritypolicy.policy/dynatrace-kubernetes-monitoring created
podsecuritypolicy.policy/dynatrace-operator created
podsecuritypolicy.policy/dynatrace-routing created
role.rbac.authorization.k8s.io/dynatrace-dynakube-oneagent created
role.rbac.authorization.k8s.io/dynatrace-dynakube-oneagent-unprivileged created
role.rbac.authorization.k8s.io/dynatrace-kubernetes-monitoring created
role.rbac.authorization.k8s.io/dynatrace-operator created
role.rbac.authorization.k8s.io/dynatrace-routing created
clusterrole.rbac.authorization.k8s.io/dynatrace-kubernetes-monitoring created
clusterrole.rbac.authorization.k8s.io/dynatrace-operator created
rolebinding.rbac.authorization.k8s.io/dynatrace-dynakube-oneagent created
rolebinding.rbac.authorization.k8s.io/dynatrace-dynakube-oneagent-unprivileged created
rolebinding.rbac.authorization.k8s.io/dynatrace-kubernetes-monitoring created
rolebinding.rbac.authorization.k8s.io/dynatrace-operator created
rolebinding.rbac.authorization.k8s.io/dynatrace-routing created
clusterrolebinding.rbac.authorization.k8s.io/dynatrace-kubernetes-monitoring created
clusterrolebinding.rbac.authorization.k8s.io/dynatrace-operator created
deployment.apps/dynatrace-operator created
W0601 05:46:39.025776   29593 helpers.go:553] --dry-run is deprecated and can be replaced with --dry-run=client.
secret/dynakube configured

Applying DynaKube CustomResource...
dynakube.dynatrace.com/dynakube created

Adding cluster to Dynatrace...
Kubernetes monitoring successfully setup.
$

</code></pre>
<aside class="warning"><p>Note that it will take about 5 mins for data to appear within Dynatrace</p>
</aside>
<aside class="special"><p>Dynatrace handles automatic deployment of OneAgents as well as automatic k8s integration.</p>
</aside>
<h2 is-upgraded>Validate the installation in Deployment status</h2>
<p>Click on <strong>Show deployment status</strong> to check the status of the connected host.</p>
<p>You should be able to see a connected host as per the image below.</p>
<p class="image-container"><img alt="Deploy" src="img/297084c8c0c99ffa.png"></p>
<aside class="special"><p>Dynatrace Documentation is referenced <a href="https://www.dynatrace.com/support/help/technology-support/operating-systems/linux/" target="_blank">here</a></p>
</aside>
<h2 is-upgraded>Restart Sockshop application</h2>
<p>To restart the sample app Sockshop execute the following command:</p>
<pre><code language="language-bash" class="language-bash">cd sockshop
./recycle-sockshop-frontend.sh
./recycle-sockshop-frontend-production.sh
</code></pre>
<h2 is-upgraded>Explore the Sockshop Application</h2>
<p>Within Dynatrace, follow the steps below to get Sockshop URL:</p>
<ul>
<li>Click on the <strong>hostname</strong> in the OneAgent deployment screen.</li>
<li>Expand <strong>Properties and tag</strong> in Host view</li>
<li><strong>Select and Copy</strong> Public Host name from the metadata</li>
<li><strong>Amend the Public Host name</strong> to match the following format: <ul>
<li>Sockshop Production <code>http://production.front-end.<public-ip>.nip.io/</public-ip></code></li>
<li>Sockshop Dev <code>http://dev.front-end.<public-ip>.nip.io</public-ip></code></li>
</ul>
</li>
</ul>
<h2 is-upgraded>Explore the Smartscape</h2>
<p>While waiting for Easy Travel to start, you can explore Dynatrace and using the Smartscape, Dynatrace will automatically discover the processes and dependencies that comprises the Easy Travel application!</p>
<p><a href="https://www.dynatrace.com/support/help/get-started/4-things-youll-absolutely-love-about-dynatrace/" target="_blank">4 things</a> that you will love about Dynatrace!</p>
<p class="image-container"><img alt="Smartscape" src="img/868e111ca8bd48bd.png"></p>
</google-codelab-step>
<google-codelab-step label="Monitoring-as-Code" duration="15">
<p>In this exercise, we will automate configuration of Dynatrace environment.</p>
<p>Using <a href="https://github.com/dynatrace-oss/dynatrace-monitoring-as-code" target="_blank">Dynatrace Monitoring as Code (Monaco)</a>, you can automate the configuration of all global Dynatrace environments without human intervention. Various use cases include:</p>
<ul>
<li>Having the ability to templatize our configuration for reusability across multiple environments</li>
<li>Interdependencies between configurations should be handled without keeping track of unique identifiers</li>
<li>Introducing the capability to easily apply – and update – the same configuration to hundreds of Dynatrace environments as well as being able to roll out to specific environments</li>
<li>Identify an easy way to promote application specific configurations from one environment to another – following their deployments from development, to hardening to production.</li>
<li>Support all the mechanisms and best-practices of git-based workflows such as pull requests, merging and approvals</li>
<li>Configurations should be easily promoted from one environment to another following their deployment from development to hardening to production</li>
</ul>
<p>To faciliate the session, you can run the monaco code with the below:</p>
<p><code>./deploy-monaco.sh</code></p>
<p>After setting it up, configure the <strong>DT_TENANT</strong> and <strong>DT_API_TOKEN</strong> variables. These can be found within the lab registration email.</p>
<pre><code language="language-bash" class="language-bash">export DT_TENANT= https://mou612.managed-sprint.dynalabs.io/e/&lt;ENV&gt;
export DT_API_TOKEN=dt0c01.IH6********************************************
</code></pre>
</google-codelab-step>
<google-codelab-step label="Request Attributes" duration="10">
<p>In this exercise, we will cover the setting up Request Attributes. These leveraged for deep visibility into all the details of your users&#39; interactions with your application.</p>
<h2 is-upgraded>Creating Request Attributes</h2>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Request Attributes</strong></p>
<p>Click on <strong>Define a new request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute name - <strong>Size</strong></li>
<li>Click on <strong>Add new data source</strong></li>
<li>Request attribute source - <strong>Web request URL query parameter</strong></li>
<li>Specify where attribute is captured - <strong>Capture from both client and server side and store where found</strong></li>
<li>Parameter name - <strong>size</strong></li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Request-attribute" src="img/9442c8e1d9a1c982.png"></p>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Request Attributes</strong></p>
<p>Click on <strong>Define a new request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute name - <strong>Tags</strong></li>
<li>Click on <strong>Add new data source</strong></li>
<li>Process group tags -<strong>[Kubernetes]app:front-end.stable</strong></li>
<li>Request attribute source - <strong>Web request URL query parameter</strong></li>
<li>Specify where attribute is captured - <strong>Capture from both client and server side and store where found</strong></li>
<li>Parameter name - <strong>tags</strong></li>
<li><strong>Expand out</strong> Further restrict or process captured parameters</li>
<li>2. Spilt into multiple attribute values using <code>%2C</code></li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Request-attribute" src="img/ef86c2694be265d3.png"></p>
<aside class="warning"><p>Note that examples of <strong>Request Attributes</strong> have also been created for you and we are doing these for the purposes of running through the request attribute creation process.</p>
</aside>
<h2 is-upgraded>Validate of Request Attribute</h2>
<p>Go to <strong>Transactions and services</strong> and filter on <strong>Request Attributes: Tags</strong></p>
<p>Drill into the filtered service - <strong>front-end.production</strong></p>
<p>Click on <strong>View dynamic requests</strong> and validate the key-value pairs of Tags under the <strong>Request Attribute</strong> tab.</p>
<p>Repeat the steps above for <strong>Request Attributes: Size</strong></p>
<p class="image-container"><img alt="Request-attribute" src="img/38780e4eac54dfb6.png"></p>
</google-codelab-step>
<google-codelab-step label="SLO" duration="15">
</google-codelab-step>
<google-codelab-step label="Dashboards" duration="15">
<p>Refer to the left navigation bar and go to Dashboards. Dynatrace has now prebuilt dashboard templates such as <strong>Application performance report</strong> and <strong>Real User Monitoring</strong> dashboards.</p>
<p class="image-container"><img alt="Dashboards" src="img/86c6cf8398494a26.png"></p>
<p>Drill down into each of these dashboards and explore the various dashboard widgets for App Owners and Business Users.</p>
<p class="image-container"><img alt="Session-properties" src="img/c6a7cd4305bfa6a.png"></p>
</google-codelab-step>
<google-codelab-step label="Feedback" duration="3">
<p>We hope you enjoyed this lab and found it useful. We would love your feedback! </p>
<google-codelab-survey survey-id="cloud-native-observability-1">
<h4>How was your overall experience with this lab?</h4>
<paper-radio-group>
<paper-radio-button>Excellent</paper-radio-button>
<paper-radio-button>Good</paper-radio-button>
<paper-radio-button>Average</paper-radio-button>
<paper-radio-button>Fair</paper-radio-button>
<paper-radio-button>Poor</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<google-codelab-survey survey-id="cloud-native-observability-2">
<h4>What did you benefit most from this lab?</h4>
<paper-radio-group>
<paper-radio-button>Automated Kubernetes Observability</paper-radio-button>
<paper-radio-button>Learning Monitoring as Code</paper-radio-button>
<paper-radio-button>Learning Metric Ingestion</paper-radio-button>
<paper-radio-button>Understanding Real User Monitoring setup</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<google-codelab-survey survey-id="cloud-native-observability-3">
<h4>How likely are you to recommend this lab to a friend or colleague?</h4>
<paper-radio-group>
<paper-radio-button>Very Likely</paper-radio-button>
<paper-radio-button>Moderately Likely</paper-radio-button>
<paper-radio-button>Neither Likely nor unlikely</paper-radio-button>
<paper-radio-button>Moderately Unlikely</paper-radio-button>
<paper-radio-button>Very Unlikely</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<aside class="special"><p>💡 For other ideas and suggestions, please <a href="mailto:APAC-SE-Central@dynatrace.com?subject=Kubernetes Workshop - Ideas and Suggestions" target="_blank"><strong>reach out via email</strong></a>.</p>
</aside>
</google-codelab-step>
</google-codelab>
<script src="../../elements/codelab-elements/native-shim.js"></script>
<script src="../../elements/codelab-elements/custom-elements.min.js"></script>
<script src="../../elements/codelab-elements/prettify.js"></script>
<script src="../../elements/codelab-elements/codelab-elements.js"></script>
<script src="//support.google.com/inapp/api.js"></script>
</body>
</html>
