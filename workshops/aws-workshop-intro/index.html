
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Lab setup</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="../../elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid="UA-175467274-1"
                  id="aws-workshop-intro"
                  title="Lab setup"
                  environment="web"
                  feedback-link="mailto:alliances@dynatrace.com">
    
      <google-codelab-step label="Overview" duration="0">
        <p class="image-container"><img alt="image" src="img/a6cfd650cf476347.png"></p>
<p>Dynatrace is an AWS Advanced Technology Partner and AWS DevOps, Migration, and Containers Competency Partner.</p>
<p>Dynatrace has pioneered and expanded the collection of observability data in highly dynamic cloud environments with the Dynatrace OneAgent. When an organization installs the OneAgent, it automatically detects all applications, containers, services, processes, and infrastructure in real-time with zero manual configuration or code changes. System components are automatically instrumented collect not only metrics, logs and traces, but a broader view of your environment including full topological model with entity relationships, code-level detail, and user experience – all in context.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li><strong>AWS account</strong>: Access to an AWS account will be provided</li>
<li><strong>Dynatrace environment</strong>: Access to a Dynatrace environment will be provided</li>
</ul>
<h2 is-upgraded>We require every attendee to:</h2>
<ul>
<li>Be able to run basic <a href="http://mally.stanford.edu/~sr/computing/basic-unix.html" target="_blank">Unix commands</a></li>
<li>Be familiar with basic <a href="https://aws.amazon.com/getting-started/fundamentals-core-concepts/" target="_blank">AWS cloud concepts</a></li>
<li>Be familiar with <a href="https://aws.amazon.com/containers/" target="_blank">container concepts</a></li>
<li>Please <strong>ASK QUESTIONS</strong> and <strong>INTERACT</strong></li>
</ul>
<h2 is-upgraded>Workshop structure</h2>
<p>The workshop breaks down into three sections</p>
<ul>
<li>Prerequisites - Ensure your Dynatrace and AWS accounts are set-up</li>
<li>Workshop Labs - Divided into modules, some labs include a step to run scripts that will provision AWS resources, deploy sample application, and configure Dynatrace.</li>
<li>Cleanup Resources - Tear down workshop resources and keep on using the Free Trial!</li>
</ul>
<h2 is-upgraded>Workshop Learning Objectives</h2>
<ul>
<li>Setup a Dynatrace environment and sample applications within AWS</li>
<li>Jump in and fully analyze an application within Dynatrace</li>
<li>Start to see and understand application usage patterns, infrastructure consumption, service dependencies, benchmarking performance and how service levels can be tightly ensured.</li>
</ul>
<p>You are now in the drivers seat for enabling modern operations for cloud native architectures!</p>


      </google-codelab-step>
    
      <google-codelab-step label="AWS account" duration="0">
        <p>You will be provided with an AWS account via the AWS Event Engine service.</p>
<ol type="1">
<li>If you are currently logged in to an AWS Account, please log out using this <a href="https://console.aws.amazon.com/console/logout!doLogout" target="_blank">link</a></li>
<li>Connect to the portal by clicking the button or browsing to <a href="https://dashboard.eventengine.run" target="_blank">https://dashboard.eventengine.run</a>. The following screen shows up. Enter the provided hash in the text box. The button in the bottom right corner changes to <strong><em>Accept Terms &amp; Login</em></strong>. Click on that button to continue. <img alt="Image" src="img/9c0efb9adaade717.png"></li>
<li>Use OTP and enter the email address to recevie the OTP. <img alt="Image" src="img/beb09a597405b39a.png"></li>
<li>Once on the Team dashboard page, click the <strong><em>AWS console</em></strong> button that opens a popup. <img alt="Image" src="img/9de48a1418175194.png"></li>
<li>On the popup, click on <strong><em>Open AWS console</em></strong> button which opens the AWS portal. <img alt="Image" src="img/385740ec7d68bee7.png"></li>
<li>One the new browser tab, you should see the AWS portal. <img alt="Image" src="img/a3df29c3124ce0c8.png"></li>
<li>Once you are in the AWS portal, please select <strong><em>ap-southeast-2 (Sydney)</em></strong> as the region. We will be creating AWS resources in the Sydney region for this hands on</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Clone scripts" duration="0">
        <ol type="1">
<li>Open up Cloudshell. In this lab, we will be using AWS Cloudshell. To open the Cloudshell, click on the Cloudshell icon at the top of the AWS console. This make take a minute to complete. <img alt="Image" src="img/e5d868238546be70.png"></li>
<li>Clone the workshop scripts. Once you have the Cloudshell open, you need to get some scripts that will automate the workshop setup. Run this command:</li>
</ol>
<pre><code language="language-bash" class="language-bash">git clone https://github.com/dt-alliances-workshops/aws-modernization-dt-orders-setup.git
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Collating information" duration="0">
        <ol type="1">
<li>Open up a text editor on your PC/Mac</li>
<li>Input these in the text editior  <ul>
<li>Dynatrace URL: https://mou612.managed-sprint.dynalabs.io/e/<strong>REPLACE with your environmentID</strong></li>
<li>Hint: It is easier to <strong><em>copy the URL from the browser</em></strong></li>
<li>Dynatrace access token: <strong>Steps to get token shown below</strong></li>
</ul>
</li>
<li>Capture the Dynatrace access token  <ul>
<li>Login into Dynatrace</li>
<li>Choose the <strong>Access Tokens</strong> option from bottom of the left side menu <img alt="image" src="img/7fcc670d0003ebc4.png"></li>
<li>On the create token page, click the <strong>Generate new token</strong> button</li>
<li>On the new token page, Enter a name like <strong>aws-workshop</strong></li>
<li>Scope  <ul>
<li><strong><em>Read SLO</em></strong>, <strong><em>Write SLO</em></strong></li>
<li><strong><em>Read configuration</em></strong>, <strong><em>Write configuration</em></strong></li>
<li><strong><em>Access problem and event feed, metrics, and topology</em></strong></li>
<li><strong><em>PaaS integration - Installer download</em></strong>, <strong><em>PaaS integration - Support alert</em></strong></li>
</ul>
</li>
<li>When completed, you should have the follow scopes defined <img alt="image" src="img/46098df68e97733e.png"></li>
</ul>
</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Capture Setup Inputs" duration="0">
        <p>The next steps of this guide will have you gather various information from your Dynatrace environment needed to configure your environment and for the lab exercises.</p>
<p>From your Dynatrace environment, you will capture:</p>
<ul>
<li>Dynatrace Base URL</li>
<li>Dynatrace API token</li>
</ul>
<p>1. Execute</p>
<pre><code language="language-bash" class="language-bash">cd ~/aws-modernization-dt-orders-setup/provision-scripts
./input-credentials.sh
</code></pre>
<p>2. Copy the Dynatrace Base URL and API token values from your text editor</p>
<p>3. You will see additional inputs for the name of the AWS resources used in the labs. Accept the default values.</p>
<p>4. Verify Inputs</p>
<pre><code language="language-bash" class="language-bash">Please confirm all are correct:
--------------------------------------------------
Dynatrace Base URL       : https://mou612.managed-sprint.dynalabs.io/e/abcd-1234-xxxx-yyyy
Dynatrace API Token      : ggggggggggggggggggggggg
--------------------------------------------------
Monolith Host Name       : dt-orders-monolith
Services Host Name       : dt-orders-services
Cluster Name             : dynatrace-workshop-cluster
===================================================================
Saved credential to: ../gen/workshop-credentials.json
{
    &#34;DT_BASEURL&#34;: &#34;https://mou612.managed-sprint.dynalabs.io/e/abcd-1234-xxxx-yyyy&#34;,
    &#34;DT_API_TOKEN&#34;: &#34;ggggggggggggggggggggggg&#34;,
    &#34;HOSTNAME_MONOLITH&#34;: &#34;dt-orders-monolith&#34;,
    &#34;HOSTNAME_SERVICES&#34;: &#34;dt-orders-services&#34;,
    &#34;CLUSTER_NAME&#34;: &#34;dynatrace-workshop-cluster&#34;
}
</code></pre>
<p>5. After you confirm, the script will show the saved values in the <strong>~/aws-modernization-dt-orders-setup/gen/workshop-credentials.json</strong> file.</p>
<p>6. If you mess up, you can re-run the script again and will prompt you again for each value.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Configure Dynatrace" duration="0">
        <p>The script will run fast while it adds the following Dynatrace configuration:</p>
<ul>
<li>Set global Frequent Issue Detection settings to Off</li>
<li>Adjust the Service Anomaly Detection</li>
<li>Add Management Zones</li>
<li>Add Auto Tagging Rules to drive management zone and SLO settings</li>
<li>Add SLOs for a use in custom dashboards</li>
</ul>
<p>1. Execute the scripts to configure Dynatrace for the <strong>monolith</strong> application:</p>
<pre><code language="language-bash" class="language-bash">cd ~/aws-modernization-dt-orders-setup/workshop-config
./setup-workshop-config.sh monolith-vm
</code></pre>
<p>2. Execute the scripts to configure Dynatrace for the <strong>micro-services</strong> application:</p>
<pre><code language="language-bash" class="language-bash">cd ~/aws-modernization-dt-orders-setup/workshop-config
./setup-workshop-config.sh services-vm
</code></pre>
<p>After running each of the above scripts, you should get an output similar to the following. Ensure that at the end of the script is states <strong><em>Deployment finished without errors</em></strong></p>
<pre><code>..
...
2021-10-27 00:16:24 INFO  Deployment summary:
2021-10-27 00:16:24 INFO  Deployment finished without errors
2021-10-27 00:16:24 INFO  There is no delete file delete.yaml found in monaco-files/projects/delete.yaml. Skipping delete config.
===================================================================================
Setting FrequentIssueDetection OFF
===================================================================================
Setting ServiceAnomalyDetection

-----------------------------------------------------------------------------------
Done Setting up Workshop config
End: Wed Oct 27 00:16:24 UTC 2021
-----------------------------------------------------------------------------------
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Provision AWS resources" duration="0">
        <p>You will now run 2 CloudFormation script that will do the following:</p>
<ul>
<li>Add a VPC</li>
<li>Add EC2 instance with a new security group that opens up the required ports to access the sample application</li>
<li>At EC2 startup, it installs Docker and Docker-Compose</li>
<li>At EC2 startup, it installs the OneAgent for your Dynatrace tenant</li>
<li>Starts up the sample application</li>
<li>The OneAgent which was installed will automatically discover the application running in the EC2 instance and starts to provide Full Stack observability.</li>
</ul>
<p>These CloudFormation scripts can help you to automate both <strong>AWS resource provisioning</strong> and <strong>Dynatrace components</strong> as well! This is the automated observability that Dynatrace provides out of the box</p>
<h2 is-upgraded>Step 1: Create 1st Cloudformation Stack</h2>
<ol type="1">
<li>In the AWS console, navigate to Cloudformation Stack <img alt="Image" src="img/e128633c0ee8af5f.png"></li>
<li>On the Cloudformation Stack page, click the <strong>Create Stack</strong> button and the <strong>With new resources</strong> option.</li>
<li>Use your browser, access the CloudFormation script and <strong>save as</strong> on your PC/Mac  <pre><code>https://raw.githubusercontent.com/Dynatrace-APAC/partner-aws/main/workshopMonolith.yaml
</code></pre>
<img alt="image" src="img/9e66a0511230ac20.png"></li>
<li>On the Create stack page, select <strong>Upload a template file</strong>, browse your PC/Mac and select the <strong><em>workshopMonolith.yaml</em></strong> file</li>
<li>Click on <strong>Next</strong><img alt="Image" src="img/25c99d82cbcdabe.png"></li>
</ol>
<h2 is-upgraded>Step 2: Enter input parameters for monolith app</h2>
<p>On the Specify Stack Details page, enter the following values:</p>
<ol type="1">
<li>Stack Name - <strong>monolith</strong></li>
<li>DynatraceBaseUrl - <strong>Copy from the text editior</strong></li>
<li>DynatracePaasToken - The Dynatrace Access token you created earlier <strong>Copy from the text editior</strong></li>
<li>KeyPairName - <strong>leave the default value</strong> of <em>ee-default-keypair</em></li>
<li>ResourcePrefix - <strong>leave this empty</strong><img alt="image" src="img/a23f01e05ceeaf56.png"></li>
<li>Click on the <strong>next</strong> button in the next few pages</li>
<li>Finally click on <strong>create stack</strong><img alt="image" src="img/f34b07211bd51894.png"></li>
</ol>
<h2 is-upgraded>Step 3: Create 2nd Cloudformation Stack</h2>
<ol type="1">
<li>Back to the Cloudformation Stack page, click the <strong>Create Stack</strong> button and the <strong>With new resources</strong> option.</li>
<li>This time we will use a CloudFormation stack stored in a public S3 bucket as the <strong>Template source</strong>. Copy s3 URL below in this values to the Amazon s3 URL field as shown below:  <pre><code>https://aws-modernize-workshop-stg-cloudformation.s3.us-west-2.amazonaws.com/workshopServices.yaml 
</code></pre>
<img alt="image" src="img/d07ff2a73e19114.png"></li>
<li>Click on the <strong>next</strong> button</li>
</ol>
<h2 is-upgraded>Step 4: Enter input parameters for micro-services app</h2>
<p>On the Specify Stack Details page, enter the following values:</p>
<ol type="1">
<li>Stack Name - <strong>microservice</strong></li>
<li>DynatraceBaseUrl - <strong>Copy from the text editior</strong></li>
<li>DynatracePaasToken - The Dynatrace Access token you created earlier <strong>Copy from the text editior</strong></li>
<li>KeyPairName - <strong>leave the default value</strong> of <em>ee-default-keypair</em></li>
<li>ResourcePrefix - <strong>leave this empty</strong></li>
<li>Simiar to the above, click on the <strong>next</strong> button in the next few pages and finally click on <strong>create stack</strong>.</li>
</ol>
<h2 is-upgraded>Step 5: Review CloudFormation Output</h2>
<p>The CloudFormation may take a few minutes, but you can check the CloudFormation output to ensure that all the AWS resources were provisioned successfully.</p>
<p>Monitor CloudFormation stack status within the AWS console. Navigate to the CloudFormation page or just navidate to: <a href="https://console.aws.amazon.com/cloudformation/home" target="_blank">https://console.aws.amazon.com/cloudformation/home</a></p>
<p>When it is complete, it will show a <strong>CREATE_COMPLETE</strong> status as shown below.</p>
<p class="image-container"><img alt="image" src="img/1dbc045e3f14e23a.png"></p>
<aside class="warning"><p>The process to provision everything will take ~5 minutes, so please be patient.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Summary" duration="0">
        <p>In this section, you should have completed the following:</p>
<p>✅ Ensure your Dynatrace account is ready</p>
<p>✅ Ensure your AWS Account is ready</p>
<p>✅ Create and gather Dynatrace URLs &amp; Tokens needed to provision the workshop</p>
<p>✅ Configure Dynatrace</p>
<p>✅ Provision AWS resources</p>
<h2 is-upgraded>Next Steps</h2>
<p>You are now ready to proceed with the labs where you provision resources and follow the lab guides.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="../../elements/codelab-elements/native-shim.js"></script>
  <script src="../../elements/codelab-elements/custom-elements.min.js"></script>
  <script src="../../elements/codelab-elements/prettify.js"></script>
  <script src="../../elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
