
<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes">
<meta name="theme-color" content="#4F7DC9">
<meta charset="UTF-8">
<title>Advanced Observability with Dynatrace</title>
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
<link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
<style>
.success{color:#1e8e3e}.error{color:red} </style>
</head>
<body>
<google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
<google-codelab codelab-gaid="UA-175467274-1" id="advanced-observability" title="Advanced Observability with Dynatrace" environment="web" feedback-link="mailto:APAC-SE-Central@dynatrace.com">
<google-codelab-step label="Introduction" duration="1">
<p>This repository contains the hands on for the Advanced Observability Workshop.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Dynatrace SaaS/Managed Account. Get your free SaaS trial <a href="https://www.dynatrace.com/trial/" target="_blank">here</a>.</li>
<li>AWS account, with the ability to create an EC2 instance from a public AMI. Signup to a free trial <a href="https://aws.amazon.com/free/" target="_blank">here</a>.</li>
<li>Chrome Browser</li>
<li>SSH client such as <a href="https://mobaxterm.mobatek.net/" target="_blank">mobaxterm</a>.</li>
</ul>
<h2 is-upgraded>Lab Setup</h2>
<p>The following steps are used for this lab:</p>
<ul>
<li>Sample Application <ul>
<li>Sample App is based on <a href="https://github.com/Dynatrace/easyTravel-Docker" target="_blank">easyTravel Docker</a></li>
<li>Follow the <a href="https://github.com/Dynatrace-APAC/Workshop-DEM/tree/master/Prerequisite%20Actions" target="_blank">Prerequisite Actions</a> to create the application that will be used throughout this workshop.</li>
</ul>
</li>
</ul>
<h2 class="checklist" is-upgraded>What You&#39;ll Learn</h2>
<ul class="checklist">
<li>Install OneAgent using Ansible CLI</li>
<li>Learn Request Attributes for deep code level capture</li>
<li>Learn Session Properties for advanced dashboarding</li>
<li>Learn Metric Ingestion for automated baselines across all entities</li>
</ul>
</google-codelab-step>
<google-codelab-step label="Automate Agent Rollout" duration="15">
<p>In this exercise, we will deploy the OneAgent to a Linux instance via Ansible.</p>
<p>Based off our <a href="https://github.com/Dynatrace/Dynatrace-OneAgent-Ansible" target="_blank">Dynatrace Ansible Github</a>, you can rollout Dynatrace Oneagent easily across on Linux and Windows Operating Systems with different available configurations and ensures the OneAgent service maintains a running state. It also provides the tasks to interact with the various OneAgent configuration files.</p>
<p>Adapting from an <a href="https://github.com/popecruzdt/dt-ansible" target="_blank">Ansible example</a>, we will be installing that on our host. Other Ansible playbooks</p>
<p><a href="https://github.com/popecruzdt/dt-ansible/blob/popecruzdt/dt-oneagent-install-linux.yml" target="_blank">Ansible for Linux</a></p>
<h2 is-upgraded>Installing Ansible</h2>
<p>Use the command below to setup Ansible in your Linux host</p>
<p><code>wget -O- https://raw.githubusercontent.com/Dynatrace-APAC/Workshop-Advanced-Observability/master/setup_ansible.sh | bash</code></p>
<h2 is-upgraded>Download the Ansible playbook</h2>
<p>Use the command below to setup Ansible in your Linux host</p>
<p><code>wget https://raw.githubusercontent.com/popecruzdt/dt-ansible/popecruzdt/dt-oneagent-install-linux.yml</code></p>
<p>Using <code>more dt-oneagent-install-linux.yml</code>, we can explore the file to preview the necessary variables that we need to provide. For the purposes of the lab, we will use only be using Ansible to rollout on a host. But in a real world context, you can run the playbook across multiple hosts or environments.</p>
<pre><code># dynatrace oneagent install on linux
# hosts_group -&gt; inventory group of hosts to execute playbook on
# dt_api_endpoint -&gt; dynatrace environment api endpoint (include trailing /)
# dt_api_token -&gt; dynatrace api install token
# dt_host_group -&gt; dynatrace host group name
# dt_app_log_content_access -&gt; flag to enable or disable log analytics on host (0 or 1)
# dt_infra_only -&gt; flag to set cloud infrastructure monitoring mode on host (0 or 1)
---
-
  hosts: localhost
  name: &#34;dynatrace oneagent install on linux&#34;
  tasks:
    -
      name: &#34;validate ansible execution on linux with sudo access&#34;
      shell:
        cmd: ls /opt
      become: yes
      changed_when: False
    # Check the latest available OneAgent version
    -
</code></pre>
<h2 is-upgraded>Creating the PaaS Token</h2>
<p>Go to <strong>Settings &gt; Integration &gt; Platform as a Service</strong></p>
<p>Click on <strong>Generate token</strong> and give a token name eg. <strong>Ansible</strong></p>
<p>Click on <strong>Generate</strong> and <strong>copy</strong> the token by selecting <strong>Reveal token</strong> to use for the next step.</p>
<p class="image-container"><img alt="Deploy" src="img/75bbe5061c351cde.png"></p>
<h2 is-upgraded>Running the playbook</h2>
<p>Gather and adjust the variables which you can use for the playbook.</p>
<p><strong>EXAMPLE</strong></p>
<pre><code>ansible-playbook \
-e dt_api_token=&lt;PAAS-TOKEN&gt; \
-e dt_host_group=tech-labs \
-e dt_app_log_content_access=1 \
-e dt_infra_only=0 \
-e dt_api_endpoint=https://mou612.managed-sprint.dynalabs.io/e/&lt;DT-ENV&gt;/api/v1/ \
dt-oneagent-install-linux.yml
</code></pre>
<p><strong>Paste</strong> the command into your terminal window and tweak the <strong>dt_api_token</strong> and <strong>dt_api_endpoint</strong> variables. Replace from token you copied earlier. You can get your from within the Dynatrace environment from the browser.</p>
<p class="image-container"><img alt="Deploy" src="img/82f926ac9a2f26e6.png"></p>
<p>Example:</p>
<pre><code>TO DO OUTPUT EXAMPLE
$

</code></pre>
<h2 is-upgraded>Validate the installation in Deployment status</h2>
<p class="image-container"><img alt="Deploy" src="img/b95c02828c19e39.jpg"></p>
<p>Reference: https://www.dynatrace.com/support/help/technology-support/operating-systems/linux/</p>
</google-codelab-step>
<google-codelab-step label="Automatic Discovery &amp; Instrumentation" duration="0">
<h2 is-upgraded>Start Sample Application</h2>
<p>Run the command below to setup the Sample Application Easytravel.</p>
<p><code>wget -O- https://raw.githubusercontent.com/Dynatrace-APAC/Workshop-Advanced-Observability/master/setup_easyTravel.sh | bash</code></p>
<p>You can check out status by referring to the logs.</p>
<p><code>tail -50f nohup.out</code></p>
<h2 is-upgraded>Explore the Smartscape</h2>
<p>While waiting for Easy Travel to start, you can explore Dynatrace and using the Smartscape, Dynatrace will automatically discover the processes and dependencies that comprises the Easy Travel application!</p>
<p><a href="https://www.dynatrace.com/support/help/get-started/4-things-youll-absolutely-love-about-dynatrace/" target="_blank">4 things</a> that you will love about Dynatrace!</p>
<p class="image-container"><img alt="Smartscape" src="img/868e111ca8bd48bd.png"></p>
</google-codelab-step>
<google-codelab-step label="Session Properties" duration="15">
<p>In this exercise, we will cover the setting up Session Properties with Request Attributes. These leveraged for deep visibility into all the details of your users&#39; interactions with your application.</p>
<h2 is-upgraded>Enable Real time updates for Java</h2>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Deep Monitoring &gt; Real-time updates</strong>.</p>
<p class="image-container"><img alt="Deploy" src="img/d7ea31da01bf3f15.png"></p>
<h2 is-upgraded>Creating Request Attributes</h2>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Request Attributes</strong></p>
<p>Click on <strong>Define a new request attribute</strong> and use the following:</p>
<ul>
<li>Name â€“ <strong>Loyalty status</strong></li>
<li>Data type â€“ Text (remains unchanged)</li>
<li>First value (remains unchanged)</li>
<li>Leave text as-is (remains unchanged)</li>
<li>Request attribute source - <strong>Web request URL query parameter</strong></li>
<li>Select <strong>Capture on server side</strong> on Drop down menu</li>
<li>Parameter name - <strong>loyalty</strong></li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Request-attribute" src="img/940260be93ad6e.gif"></p>
<p>Click on <strong>Add new data source</strong> within the <strong>same request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute source â€“ <strong>Java method parameter(s)</strong></li>
<li>Click on <strong>Select method sources</strong></li>
<li>Select <strong>business.backend</strong></li>
<li>Search for <strong>BookingService</strong></li>
<li>Select <strong>Use the selected class</strong></li>
<li>Search for <strong>checkLoyaltyStatus</strong></li>
<li>Choose <strong>2:java.lang.String</strong> on Capture Drop down</li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Request-attribute" src="img/408920b64892f607.gif"></p>
<p>Click on <strong>Add new data source</strong> within the <strong>same request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute source â€“ <strong>Java method parameter(s)</strong></li>
<li>Click on <strong>Select method sources</strong></li>
<li>Select <strong>business.backend</strong></li>
<li>Search for <strong>AuthenticationService</strong></li>
<li>Select <strong>Use the selected class</strong></li>
<li>Search for <strong>getLoyaltyStatus</strong></li>
<li>Choose <strong>Return value</strong> on Capture Drop down</li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Request-attribute" src="img/d3abf422239420a2.gif"></p>
<p>Ensure that right data sources are in below order and click on <strong>save</strong> on the top right.</p>
<ol type="1">
<li>Authentication Service</li>
<li>Booking Service</li>
<li>URL query parameter</li>
</ol>
<p class="image-container"><img alt="Request-attribute" src="img/7f8cd3f6fe958e2d.png"></p>
<h2 is-upgraded>Validate of Loyalty Status Request Attribute</h2>
<p>Go to <strong>Transactions and services</strong> and filter on <strong>AuthenticationService</strong>.</p>
<p>Click on <strong>View requests</strong> and validate the key-value pairs of Loyalty Status under the <strong>Request Attribute</strong> tab.</p>
<p class="image-container"><img alt="Request-attribute" src="img/82c694100abffcef.png"></p>
<h2 is-upgraded>Define Session Properties</h2>
<p>Go to <strong>Applications &gt; easyTravel Angular &gt; Settings &gt; Session and user action properties</strong></p>
<p>Click on <strong>Add property &gt; Custom defined property</strong> and use the following:</p>
<ul>
<li>Expression type â€“ <strong>Server side request attribute</strong></li>
<li>RA name â€“ <strong>Loyalty status</strong></li>
<li>Display name â€“ <strong>Loyalty status</strong></li>
<li>Key â€“ <strong>loyalty_status</strong></li>
<li>Toggle on <strong>Store as session property</strong></li>
<li>Aggregation type â€“ Last Value</li>
<li>Click on <strong>Save propery</strong></li>
</ul>
<p class="image-container"><img alt="Session-properties" src="img/a709e677b47b9fa1.gif"></p>
<p>Click on <strong>Add property &gt; Custom defined property</strong> and another property with the following:</p>
<p>Expression type â€“ CSS selector Data type â€“ Double CSS selector â€“ button[name=&#34;payment:pay&#34;] Display name â€“ Revenue Key â€“ revenue Store as session property Cleanup rule - Pay\s\$(.*?).</p>
<p class="image-container"><img alt="Session-properties" src="img/cec93607fb229579.png"></p>
</google-codelab-step>
<google-codelab-step label="Calculated Service Metrics Properties" duration="15">
<p>In this exercise, we will cover the setting up Calulated Service Metrics with Request Attributes. These leveraged for deep visibility into all the details of your users&#39; interactions with your application.</p>
<h2 is-upgraded>Creating Request Attributes</h2>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Request Attributes</strong></p>
<p>Click on <strong>Define a new request attribute</strong> and use the following:</p>
<ul>
<li>Name â€“ <strong>Revenue</strong></li>
<li>Data type â€“ <strong>Double</strong></li>
<li><strong>Sum of numeric values</strong></li>
<li>Leave text as-is (remains unchanged)</li>
<li><strong>Check</strong> the Allow this attribute to access unmasked personal data</li>
<li>Request attribute source - <strong>Web request URL query parameter</strong></li>
<li>Select <strong>Capture on both client and server side</strong> on Drop down menu</li>
<li>Parameter name - <strong>amount</strong></li>
<li>Click on <strong>Save</strong></li>
</ul>
<p>Click on <strong>Add new data source</strong> within the <strong>same request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute source â€“ <strong>Java method parameter(s)</strong></li>
<li>Click on <strong>Select method sources</strong></li>
<li>Select <strong>business.backend</strong></li>
<li>Search for <strong>BookingService</strong></li>
<li>Select <strong>Use the selected class</strong></li>
<li>Search for <strong>storeBooking</strong></li>
<li>Choose <strong>4:java.lang.Double</strong> on Capture Drop down</li>
<li>Click on <strong>Save</strong></li>
</ul>
<p>Click on <strong>Add new data source</strong> within the <strong>same request attribute</strong> and use the following:</p>
<ul>
<li>Request attribute source â€“ <strong>Java method parameter(s)</strong></li>
<li>Click on <strong>Select method sources</strong></li>
<li>Select <strong>com.dynatrace.easytravel.frontend.data.DataProviderInterface</strong></li>
<li>Search for <strong>DataProviderInterface</strong></li>
<li>Select <strong>Use the selected class</strong></li>
<li>Search for <strong>storeBooking</strong></li>
<li>Choose <strong>4:java.lang.Double</strong> on Capture Drop down</li>
<li>Click on <strong>Save</strong></li>
</ul>
<p class="image-container"><img alt="Session-properties" src="img/6b8c1a22ccab2aef.png"></p>
<h2 is-upgraded>Validate of Loyalty Status Request Attribute</h2>
<p>Go to <strong>Transactions and services</strong> and filter on <strong>BookingService</strong>.</p>
<p>Click on <strong>View requests</strong> and validate the key-value pairs of Loyalty Status under the <strong>Request Attribute</strong> tab.</p>
<p class="image-container"><img alt="Request-attribute" src="img/82c694100abffcef.png"></p>
<h2 is-upgraded>Define Calculated Service Metric</h2>
<p>Go to <strong>Settings &gt; Server-side service monitoring &gt; Calculated service metrics</strong></p>
<p>Click on <strong>Create new metric</strong> and use the following:</p>
<ul>
<li>Metric name â€“ <strong>Revenue/LoyaltyStatus</strong></li>
<li>Metric source â€“ <strong>Request Attribute</strong></li>
<li>Request Attribute â€“ <strong>Revenue</strong></li>
<li>Unit - <strong>Custom unit</strong></li>
<li>Text field - <strong>Dollars</strong></li>
<li>Conditions - <strong>Request Attribute â€˜Loyalty Status&#39; exists</strong></li>
<li>Conditions - <strong>Request Attribute â€˜Revenue&#39; exists</strong></li>
<li>Conditions - <strong>Web service name exists</strong></li>
<li><strong>Toggle</strong> - Spilt by dimension</li>
<li>Dimension value pattern - <strong>{RequestAttribute:LoyaltyStatus}</strong></li>
<li>Dimension name - <strong>LoyaltyStatus</strong></li>
</ul>
<p>You&#39;ll be able to preview the various dimensions across defined services</p>
<p class="image-container"><img alt="Session-properties" src="img/ab891b22d27f3d.png"></p>
</google-codelab-step>
<google-codelab-step label="Dashboards" duration="15">
<p>Refer to the left navigation bar and go to Dashboards. Dynatrace has now prebuilt dashboard templates such as <strong>Application performance report</strong> and <strong>Real User Monitoring</strong> dashboards.</p>
<p class="image-container"><img alt="Dashboards" src="img/86c6cf8398494a26.png"></p>
<p>Drill down into each of these dashboards and explore the various dashboard widgets for App Owners and Business Users.</p>
<p class="image-container"><img alt="Session-properties" src="img/c6a7cd4305bfa6a.png"></p>
</google-codelab-step>
<google-codelab-step label="Feedback" duration="3">
<p>We hope you enjoyed this lab and found it useful. We would love your feedback! </p>
<google-codelab-survey survey-id="advanced-observability-1">
<h4>How was your overall experience with this lab?</h4>
<paper-radio-group>
<paper-radio-button>Excellent</paper-radio-button>
<paper-radio-button>Good</paper-radio-button>
<paper-radio-button>Average</paper-radio-button>
<paper-radio-button>Fair</paper-radio-button>
<paper-radio-button>Poor</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<google-codelab-survey survey-id="advanced-observability-2">
<h4>What did you benefit most from this lab?</h4>
<paper-radio-group>
<paper-radio-button>Understanding Real User Monitoring setup</paper-radio-button>
<paper-radio-button>Learning Synthetic</paper-radio-button>
<paper-radio-button>Learning Session Replay</paper-radio-button>
<paper-radio-button>Learning User Session Query Language</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<google-codelab-survey survey-id="advanced-observability-3">
<h4>How likely are you to recommend this lab to a friend or colleague?</h4>
<paper-radio-group>
<paper-radio-button>Very Likely</paper-radio-button>
<paper-radio-button>Moderately Likely</paper-radio-button>
<paper-radio-button>Neither Likely nor unlikely</paper-radio-button>
<paper-radio-button>Moderately Unlikely</paper-radio-button>
<paper-radio-button>Very Unlikely</paper-radio-button>
</paper-radio-group>
</google-codelab-survey>
<aside class="special"><p>ðŸ’¡ For other ideas and suggestions, please <a href="mailto:APAC-SE-Central@dynatrace.com?subject=Kubernetes Workshop - Ideas and Suggestions" target="_blank"><strong>reach out via email</strong></a>.</p>
</aside>
</google-codelab-step>
</google-codelab>
<script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
<script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
<script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
<script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
<script src="//support.google.com/inapp/api.js"></script>
</body>
</html>
